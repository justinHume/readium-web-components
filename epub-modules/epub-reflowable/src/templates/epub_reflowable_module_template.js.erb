var EpubReflowableModule = function(spineObject, viewerSettingsObject, CFIAnnotations, bindings) {

    var EpubReflowable = {};

    // Rationale: The order of these matters
    <%= alternate_style_tag_selector %>
    <%= reflowable_element_info %>
    <%= reflowable_layout %>
    <%= reflowable_page_number_logic %>
    <%= reflowable_pagination %>
    <%= reflowable_paginator %>
    <%= trigger %>
    <%= reflowable_pagination_view %>
    <%= reflowable_customizer %>
    <%= reflowable_custom_border %>
    <%= reflowable_spine_divider_view %>
    <%= reflowable_custom_theme %>

    var reflowableView = new EpubReflowable.ReflowablePaginationView({
        spineItem : spineObject,
        viewerSettings : viewerSettingsObject,
        contentDocumentCFIs : CFIAnnotations,
        bindings : bindings
    });

    // Description: The public interface
    return {

        render : function (goToLastPage, hashFragmentId) {
            return reflowableView.render(goToLastPage, hashFragmentId);
        },
        nextPage : function () {
            return reflowableView.nextPage();
        },
        previousPage : function () {
            return reflowableView.previousPage();
        },
        showPageByHashFragment : function (hashFragmentId) {
            return reflowableView.showPageByElementId(hashFragmentId);
        },
        showPageByNumber : function (pageNumber) {
            return reflowableView.showPageByNumber(pageNumber);
        },
        showPageByCFI : function (CFI) {
            return reflowableView.showPageByCFI(CFI);
        },
        numberOfPages : function () {
            return reflowableView.pages.get("numberOfPages");
        },
        currentPage : function () {
            return reflowableView.pages.get("currentPages");
        },
        onFirstPage : function () {
            return reflowableView.pages.onFirstPage();
        },
        onLastPage : function () {
            return reflowableView.pages.onLastPage();
        },
        showPagesView : function () {
            return reflowableView.showView();
        },
        hidePagesView : function () {
            return reflowableView.hideView();
        },
        setSyntheticLayout : function (isSynthetic) {
            return reflowableView.setSyntheticLayout(isSynthetic);
        },
        on : function (eventName, callback, callbackContext) {
            return reflowableView.on(eventName, callback, callbackContext);
        },
        off : function (eventName, callback) {
            return reflowableView.off(eventName, callback);
        },
        resizeContent : function () {
            return reflowableView.paginateContentDocument();
        },
        customize : function (customElement, styleNameOrCSSObject) {
            reflowableView.customizeStyles(customElement, styleNameOrCSSObject);
            return this;
        },
        addSelectionHighlight : function (id, type) { 
            return reflowableView.annotations.addSelectionHighlight(id, type); 
        },
        addSelectionBookmark : function (id, type) { 
            return reflowableView.annotations.addSelectionBookmark(id, type); 
        },
        addSelectionImageAnnotation : function (id) {
            return reflowableView.annotations.addSelectionImageAnnotation(id);
        },
        addHighlight : function (CFI, id, type) { 
            return reflowableView.annotations.addHighlight(CFI, id, type); 
        },
        addBookmark : function (CFI, id, type) { 
            return reflowableView.annotations.addBookmark(CFI, id, type);
        },
        addImageAnnotation : function (CFI, id) { 
            return reflowableView.annotations.addImageAnnotation(CFI, id); 
        }
    };
};
